function k = getk(material,T)
% thermal conductivity in W/mK
    cp = zeros(size(T));
    switch material
        case 'Ti'   % 100 - 800 K
            a =       24.12;
            b =   -0.006624;
            c =       17.82;
            d =   0.0001137;
            k = a*exp(b*T) + c*exp(d*T);
        case 'glass' % 3-500 K, PRB 4(6), p2029
            TG = [3.507538	6.015075	8.522613	11.03015	13.53769	16.04523	18.55276	21.0603	23.56784	26.07538	28.58291	31.09045	33.59799	36.10553	38.61307	41.1206	43.62814	46.13568	48.64322	51.15075	53.65829	56.16583	58.67337	61.1809	63.68844	66.19598	68.70352	71.21106	73.71859	76.22613	78.73367	81.24121	83.74874	86.25628	88.76382	91.27136	93.77889	96.28643	98.79397	101.3015	103.809	106.3166	108.8241	111.3317	113.8392	116.3467	118.8543	121.3618	123.8693	126.3769	128.8844	131.392	133.8995	136.407	138.9146	141.4221	143.9296	146.4372	148.9447	151.4523	153.9598	156.4673	158.9749	161.4824	163.9899	166.4975	169.005	171.5126	174.0201	176.5276	179.0352	181.5427	184.0503	186.5578	189.0653	191.5729	194.0804	196.5879	199.0955	201.603	204.1106	206.6181	209.1256	211.6332	214.1407	216.6482	219.1558	221.6633	224.1709	226.6784	229.1859	231.6935	234.201	236.7085	239.2161	241.7236	244.2312	246.7387	249.2462	251.7538	254.2613	256.7688	259.2764	261.7839	264.2915	266.799	269.3065	271.8141	274.3216	276.8291	279.3367	281.8442	284.3518	286.8593	289.3668	291.8744	294.3819	296.8894	299.397	301.9045	304.4121	306.9196	309.4271	311.9347	314.4422	316.9497	319.4573	321.9648	324.4724	326.9799	329.4874	331.995	334.5025	337.0101	339.5176	342.0251	344.5327	347.0402	349.5477	352.0553	354.5628	357.0704	359.5779	362.0854	364.593	367.1005	369.608	372.1156	374.6231	377.1307	379.6382	382.1457	384.6533	387.1608	389.6683	392.1759	394.6834	397.191	399.6985	402.206	404.7136	407.2211	409.7286	412.2362	414.7437	417.2513	419.7588	422.2663	424.7739	427.2814	429.7889	432.2965	434.804	437.3116	439.8191	442.3266	444.8342	447.3417	449.8492	452.3568	454.8643	457.3719	459.8794	462.3869	464.8945	467.402	469.9095	472.4171	474.9246	477.4322	479.9397	482.4472	484.9548	487.4623	489.9698	492.4774	494.9849	497.4925	500];
            KG = [0.09532622	0.1265504	0.1372326	0.1411989	0.1442098	0.1510854	0.162108	0.1765646	0.1918129	0.2078543	0.2244534	0.2431292	0.2618049	0.2804807	0.3013519	0.3260963	0.3508407	0.3755851	0.4003295	0.4250739	0.4498183	0.4745627	0.4993071	0.5260585	0.553343	0.5806274	0.6079119	0.6351963	0.6624808	0.6897652	0.7170497	0.7344456	0.7422273	0.750009	0.7577907	0.7655723	0.773354	0.7811357	0.7889174	0.7966991	0.8044808	0.8122625	0.8200442	0.8278259	0.8356076	0.8433893	0.851171	0.8589527	0.8667343	0.874516	0.8822977	0.8900794	0.8978611	0.9056428	0.9134245	0.9212062	0.9289879	0.9367696	0.9445513	0.952333	0.9601147	0.9678963	0.975678	0.9834597	0.9912414	0.9990231	1.006805	1.014586	1.022368	1.03015	1.037932	1.045713	1.053495	1.061277	1.069058	1.07684	1.084622	1.092403	1.100185	1.107967	1.115748	1.12353	1.131312	1.139094	1.146875	1.154657	1.162439	1.17022	1.178002	1.185784	1.193565	1.201347	1.209129	1.21691	1.224692	1.232474	1.240256	1.248037	1.255819	1.263601	1.271382	1.279164	1.286946	1.294727	1.302509	1.310291	1.318072	1.325854	1.332182	1.336851	1.341521	1.34619	1.35086	1.355529	1.360199	1.364868	1.369538	1.374208	1.378877	1.382285	1.385294	1.388304	1.391313	1.394322	1.397331	1.40034	1.403349	1.406358	1.409367	1.412376	1.415385	1.418394	1.421403	1.424412	1.427421	1.43043	1.433439	1.436448	1.439457	1.442466	1.445475	1.448484	1.451493	1.454503	1.457512	1.460521	1.46353	1.466539	1.469548	1.472557	1.475566	1.478575	1.481584	1.484593	1.487602	1.490611	1.49362	1.496629	1.499638	1.502647	1.505656	1.508665	1.511674	1.514683	1.517692	1.520702	1.523711	1.52672	1.529729	1.532738	1.535747	1.538756	1.541765	1.544774	1.547783	1.550792	1.553801	1.55681	1.559819	1.562828	1.565837	1.568846	1.571855	1.574864	1.577873	1.580882	1.583891	1.586901	1.58991	1.592919	1.595928	1.598937	1.601946	1.604955	1.607964	1.610973	1.613982	1.616991	1.62];
            
            k = interp1(TG,KG,T);
            
        case 'graphite_in' %100-800 K
            a = 1.481e4;
            b = -0.006959;
            c = -2.213e4;
            d = -0.01647;
            k = a*exp(b*T) + c*exp(d*T);

 %       case 'graphite_in'   % 100 - 800 K
 %           p1 =  -2.426e-05;
 %           p2 =      0.0464;
 %           p3 =      -30.21;
 %           p4 =        7563;
 %           P = [p1 p2 p3 p4];
 %           k = polyval(P,T);
        case 'graphite_cross'   % 100 - 800 K
            p1 =   2.541e-10;
            p2 =  -5.691e-07;
            p3 =    0.000475;
            p4 =     -0.1819;
            p5 =       30.78;
            P = [p1 p2 p3 p4 p5];
            k = polyval(P,T);
        case 'sapphire'   % 100 - 800 K
            a =        5487;
            b =    -0.02678;
            c =       94.91;
            d =   -0.002619;
            k = a*exp(b*T) + c*exp(d*T);
        case 'Si'   % 1 - 1000 K, from my calculation "ProcessDispersionCk.m"
            allT=[1.00E+00	1.15E+00	1.33E+00	1.53E+00	1.76E+00	2.02E+00	2.33E+00	2.68E+00	3.09E+00	3.56E+00	4.09E+00	4.71E+00	5.43E+00	6.25E+00	7.20E+00	8.29E+00	9.54E+00	1.10E+01	1.26E+01	1.46E+01	1.68E+01	1.93E+01	2.22E+01	2.56E+01	2.95E+01	3.39E+01	3.91E+01	4.50E+01	5.18E+01	5.96E+01	6.87E+01	7.91E+01	9.10E+01	1.05E+02	1.21E+02	1.39E+02	1.60E+02	1.84E+02	2.12E+02	2.44E+02	2.81E+02	3.24E+02	3.73E+02	4.29E+02	4.94E+02	5.69E+02	6.55E+02	7.54E+02	8.69E+02	1.00E+03];
            kT=[9.75E+00	1.45E+01	2.03E+01	2.72E+01	3.54E+01	4.57E+01	5.97E+01	8.07E+01	1.15E+02	1.71E+02	2.64E+02	4.04E+02	6.00E+02	8.54E+02	1.16E+03	1.51E+03	1.89E+03	2.30E+03	2.73E+03	3.16E+03	3.57E+03	3.92E+03	4.15E+03	4.21E+03	4.06E+03	3.72E+03	3.24E+03	2.73E+03	2.25E+03	1.82E+03	1.46E+03	1.17E+03	9.37E+02	7.48E+02	5.98E+02	4.79E+02	3.84E+02	3.08E+02	2.47E+02	1.98E+02	1.59E+02	1.28E+02	1.02E+02	8.20E+01	6.56E+01	5.25E+01	4.20E+01	3.36E+01	2.69E+01	2.15E+01];
            k = interp1(allT,kT,T);

        case 'Ge'
            data = [2.302214 1.057958
                    2.630546 1.419140
                    3.078747 1.814157
                    3.400134 2.561895
                    3.927794 3.269507
                    4.572470 4.199394
                    5.213502 4.999142
                    6.493794 6.748381
                    7.728442 8.843614
                    9.225860 10.111980
                    10.729531 11.543014
                    12.701300 12.762780
                    14.680033 12.978744
                    17.202626 13.229801
                    21.978813 13.086843
                    25.478330 11.669299
                    29.853358 10.958411
                    41.543990 7.826725
                    54.715195 5.954246
                    67.271055 5.032570
                    91.055390 3.211765
                    105.933992 2.524363
                    115.835460 2.059100
                    143.376799 1.515627
                    196.784637 1.053365
                    232.569866 0.871573
                    273.316118 0.719870
                    305.723242 0.653274];
            k = interp1(data(:,1),data(:,2)*100,T);
        case 'Ge_slack'
            data = [0        0
                    3.34972  5.58383
                    4.63249  9.50924
                    5.56152  12.37286
                    8.75978  17.20068
                    12.48309  17.94642
                    15.53080  17.95320
                    20.99439  12.77745
                    23.76617  12.47834
                    31.93578  9.48421
                    45.25898  6.67035
                    63.77049  4.13802
                    78.42898  3.14464
                    101.72959  2.18505
                    150.27095  1.35563
                    294.79661  0.59500
                    400.86542  0.42095
                    445.86072  0.37584
                    492.95092  0.36266
                    487.20305  0.33355
                    516.85736  0.31801
                    548.28861  0.31995
                    545.11982  0.28561
                    599.11153  0.29257
                    581.72703  0.27069
                    620.81019  0.24899
                    686.38961  0.23599
                    670.41907  0.21835
                    763.44235  0.20820
                    759.00423  0.19264
                    800.43490  0.19037
                    844.15104  0.18258
                    879.78437  0.17935
                    966.89570  0.18929
                    938.83914  0.17514
                    1019.73212  0.17621
                    995.99989  0.16401
                    1062.78915  0.17104
                    1175.00375  0.17005
                    1231.81959  0.17211];
            k = interp1(data(:,1),data(:,2)*100,T);
            
        case 'Ge_slack_e'
            data_top = [ 0          0
                        300         0
                        400         0
                        485.94215  0
                        534.01064  0.89811
                        583.79764  1.98488
                        615.53613  3.14291
                        655.85472  4.56928
                        690.98871  6.59983
                        738.09418  9.85818
                        779.15994  13.63302
                        806.50253  16.87419
                        829.53639  20.37248
                        877.31431  27.54446
                        914.01323  32.79376
                        936.19198  36.20435
                        969.47464  41.01590
                        994.21871  44.68959
                        1024.94020  49.15109
                        1065.04294  55.09901
                        1094.90933  59.47280
                        1120.50435  63.32115
                        1152.93605  67.95804
                        1172.55779  70.93163
                        1199.02452  74.51986
                        1213.54054  76.44553];
             data_down = [  0          0
                            300        0
                            400        0
                            674.97834  0
                            714.45843  0.96806
                            761.60955  3.26993
                            794.15333  5.55910
                            832.57906  10.63599
                            849.64379  13.17257
                            869.26553  16.14616
                            912.78039  22.61878
                            928.99001  25.06766
                            958.00545  29.26680
                            1005.77922  36.52573
                            1049.29407  42.99836
                            1090.25606  48.94702
                            1146.59748  56.73514
                            1176.44727  61.45675
                            1199.48113  64.95504
                            1212.28279  66.79226];        
                  kt = interp1(data_top(:,1),data_top(:,2)*0.1,T);
                  kd = interp1(data_down(:,1),data_down(:,2)*0.1,T);
            k = 0.5*(kt+kd);

        case 'Sibad'   % 100 - 800 K
            a =        4461;
            b =    -0.01882;
            c =       258.5;
            d =    -0.00235;
            k = a*exp(b*T) + c*exp(d*T);
        case 'Al'     % 100 - 600 K
            p1 =  -2.333e-11;
            p2 =     5.6e-08;
            p3 =  -5.117e-05;
            p4 =     0.02205;
            p5 =      -4.451;
            p6 =       572.4;
            P = [p1 p2 p3 p4 p5 p6];
            k = polyval(P,T);
        case 'Ti'   % 100 - 800 K
            a =       24.12;
            b =   -0.006624;
            c =       17.82;
            d =   0.0001137;
            k = a*exp(b*T) + c*exp(d*T);
        case 'Pd'   % 100 - 800 K
            p1 =   3.267e-10;
            p2 =  -7.086e-07;
            p3 =   0.0005729;
            p4 =     -0.1745;
            p5 =       88.87;
            P = [p1 p2 p3 p4 p5];
            k = polyval(P,T);
        case 'Sn'   % 100 - 400 K
            p1 =   0.0001875;
            p2 =     -0.1695;
            p3 =       100.1;
            P = [p1 p2 p3];
            k = polyval(P,T);
        case 'Au'   % 100 - 800 K
            p1 =   2.884e-08;
            p2 =   -5.82e-05;
            p3 =    -0.03028;
            p4 =       330.7;
            P = [p1 p2 p3 p4];
            k = polyval(P,T);
        case 'SiO2'
            A = [0.31963, 0.00452
            0.39388, 0.00888
            0.50224, 0.01548
            0.61903, 0.03264
            0.73649, 0.05124
            0.87628, 0.08185
            0.99013, 0.13539
            1.21971, 0.23588
            1.26332, 0.29559
            1.40215, 0.39016
            1.58378, 0.57152
            1.75732, 0.67974
            1.95092, 0.97859
            2.12746, 1.12421
            2.53202, 1.99310
            3.22796, 3.23930
            3.84085, 5.26539
            4.56676, 6.59644
            5.43120, 9.01340
            6.45737, 11.09757
            7.42037, 15.97552
            7.82167, 22.21637
            9.45990, 25.96438
            13.10782, 14.88775
            19.10644, 5.82583
            23.46788, 3.58152
            29.33354, 2.40140
            34.81976, 1.66718
            46.63143, 1.11769
            61.39100, 0.78940
            74.17322, 0.64071
            78.05889, 0.50241
            155.24172, 0.21430
            172.11747, 0.19307
            194.16655, 0.18007
            211.55126, 0.15135
            283.38348, 0.11067
            373.20610, 0.08826
            483.00056, 0.06567];
           k = interp1(A(:,1),A(:,2),T)*100;

        case 'Au_film'
            data = [79.80721613792439 96.68555501505375
            109.56732096606672 112.61136894510105
            139.55805208977006 128.53542989617983
            179.93025334928544 150.08129439967036
            219.83572395840181 162.1295188510975
            259.9718208630792 174.175990323556
            299.64283053514066 179.57516554695133];
            k = interp1(data(:,1), data(:,2), T,'spline');

        case 'Cu'   % 100 - 800 K
            a =       818.2;
            b =    -0.02502;
            c =       422.5;
            d =    -0.00018;
            k = a*exp(b*T) + c*exp(d*T);
        case 'Cr'
            a =       260.9;
            b =    -0.01553;
            c =       109.4;
            d =  -0.0005231;
            k = a*exp(b*T) + c*exp(d*T);
        case 'Ni'
           a =       121.2;
           b =   -0.001027;
           c =       356.8;
           d =    -0.01877;
           k = a*exp(b*T) + c*exp(d*T);
        case 'GaAs'
           if T==296
               k = 45;
           elseif(T>100 && T~=296) 
                p1 = 1.2757e-023;
                p2 = -5.9741e-020;
                p3 = 1.2264e-016;
                p4 = -1.4512e-013;
                p5 = 1.0949e-010;
                p6 = -5.5025e-008;
                p7 = 1.8671e-005;
                p8 = -0.0042397;
                p9 = 0.62187;
                p10 = -54.329;
                p11 = 2301;
                P = [p1 p2 p3 p4 p5 p6 p7 p8 p9 p10 p11];
                k = polyval(P,T);
            elseif(T<=100 && T>40) 
                p1 = -2.834e-006;
                p2 = 0.0011395;
                p3 = -0.18586;
                p4 = 15.546;
                p5 = -681.14;
                p6 = 13160;
                P = [p1 p2 p3 p4 p5 p6];
                k = polyval(P,T);
            elseif(T<=40 && T>20)
                p1 = 0.0011362;
                p2 = -0.19255;
                p3 = 12.916;
                p4 = -424.84;
                p5 = 6664.3;
                p6 = -35329;
                P = [p1 p2 p3 p4 p5 p6];
                k = polyval(P,T);
            elseif(T<=20)
                p1 = 0.010204;
                p2 = -0.54577;
                p3 = 9.3363;
                p4 = -60.896;
                p5 = 479.35;
                p6 = -1074;
                P = [p1 p2 p3 p4 p5 p6];
                k = polyval(P,T);
         
           else 
               disp('Material not found')
               k = -1;
           end  
         case 'STO'
            %From 2008 J Phys Condens Matter 20 085219
            TG = [50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300];
            KG = [19, 18, 17, 16, 15, 14.5,13,12,11.5,10.5 10];
            k = interp1(TG, KG, T, 'spline');
    end
end 